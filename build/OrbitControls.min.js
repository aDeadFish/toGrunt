/*! OrbitControls.js  */
THREE.OrbitControls=function(a,b){function c(){return 2*Math.PI/60/60*j.autoRotateSpeed}function d(){return Math.pow(.95,j.userZoomSpeed)}function e(a){j.enabled!==!1&&j.userRotate!==!1&&(a.preventDefault(),0===a.button?(x=w.ROTATE,m.set(a.clientX,a.clientY)):1===a.button?(x=w.ZOOM,p.set(a.clientX,a.clientY)):2===a.button&&(x=w.PAN),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1))}function f(a){if(j.enabled!==!1)if(a.preventDefault(),x===w.ROTATE)n.set(a.clientX,a.clientY),o.subVectors(n,m),j.rotateLeft(2*Math.PI*o.x/l*j.userRotateSpeed),j.rotateUp(2*Math.PI*o.y/l*j.userRotateSpeed),m.copy(n);else if(x===w.ZOOM)q.set(a.clientX,a.clientY),r.subVectors(q,p),r.y>0?j.zoomIn():j.zoomOut(),p.copy(q);else if(x===w.PAN){var b=a.movementX||a.mozMovementX||a.webkitMovementX||0,c=a.movementY||a.mozMovementY||a.webkitMovementY||0;j.pan(new THREE.Vector3(-b,c,0))}}function g(a){j.enabled!==!1&&j.userRotate!==!1&&(document.removeEventListener("mousemove",f,!1),document.removeEventListener("mouseup",g,!1),x=w.NONE)}function h(a){if(j.enabled!==!1&&j.userZoom!==!1){var b=0;a.wheelDelta?b=a.wheelDelta:a.detail&&(b=-a.detail),b>0?j.zoomOut():j.zoomIn()}}function i(a){if(j.enabled!==!1&&j.userPan!==!1)switch(a.keyCode){case j.keys.UP:j.pan(new THREE.Vector3(0,1,0));break;case j.keys.BOTTOM:j.pan(new THREE.Vector3(0,-1,0));break;case j.keys.LEFT:j.pan(new THREE.Vector3(-1,0,0));break;case j.keys.RIGHT:j.pan(new THREE.Vector3(1,0,0))}}this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.center=new THREE.Vector3,this.userZoom=!0,this.userZoomSpeed=1,this.userRotate=!0,this.userRotateSpeed=1,this.userPan=!0,this.userPanSpeed=2,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=1/0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var j=this,k=1e-6,l=1800,m=new THREE.Vector2,n=new THREE.Vector2,o=new THREE.Vector2,p=new THREE.Vector2,q=new THREE.Vector2,r=new THREE.Vector2,s=0,t=0,u=1,v=new THREE.Vector3,w={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},x=w.NONE,y={type:"change"};this.rotateLeft=function(a){void 0===a&&(a=c()),t-=a},this.rotateRight=function(a){void 0===a&&(a=c()),t+=a},this.rotateUp=function(a){void 0===a&&(a=c()),s-=a},this.rotateDown=function(a){void 0===a&&(a=c()),s+=a},this.zoomIn=function(a){void 0===a&&(a=d()),u/=a},this.zoomOut=function(a){void 0===a&&(a=d()),u*=a},this.pan=function(a){a.transformDirection(this.object.matrix),a.multiplyScalar(j.userPanSpeed),this.object.position.add(a),this.center.add(a)},this.update=function(){var a=this.object.position,b=a.clone().sub(this.center),d=Math.atan2(b.x,b.z),e=Math.atan2(Math.sqrt(b.x*b.x+b.z*b.z),b.y);this.autoRotate&&this.rotateLeft(c()),d+=t,e+=s,e=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,e)),e=Math.max(k,Math.min(Math.PI-k,e));var f=b.length()*u;f=Math.max(this.minDistance,Math.min(this.maxDistance,f)),b.x=f*Math.sin(e)*Math.sin(d),b.y=f*Math.cos(e),b.z=f*Math.sin(e)*Math.cos(d),a.copy(this.center).add(b),this.object.lookAt(this.center),t=0,s=0,u=1,v.distanceTo(this.object.position)>0&&(this.dispatchEvent(y),v.copy(this.object.position))},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",e,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("keydown",i,!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);